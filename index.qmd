---
title: "Calidad de aire"
author: "MESOMI"
logo: quarto.png
lang: es
format: 
  dashboard:
    orientation: columns
    theme:
      light: flatly
      dark: cyborg
execute: 
  message: false
  warning: false
editor_options: 
  chunk_output_type: console
---

```{r}
#| include: false
library(tidyverse)
library(openair)
library(openxlsx)
library(zoo)
library(ggthemes)
library(ggforce)
library(patchwork)
library(ggrepel)
source("Scripts/ECA.R")

df <- ECA(meteo = "input/CR1000_JULIO_2024.csv",
          gases = "input/eca_2024_julio.csv",
          pm = "input/1405A227561402_2024-08-01_09-11-26.csv",
          fecha_inicio = "2024-07-17",
          fecha_fin = "2024-07-31",
          estacion = "Vigil",
          tipo = "lista")
```

# Datos del 2024
## column {.tabset}
### EMCA - 01 {.tabset}
#### PM10
```{r}
#| title: "PM10 diario"

df$eca<- df$eca %>% 
  mutate(fecha = as.Date(fecha, format = "%d-%B"))

med <- df$eca$fecha

g1 <- df$eca %>% 
  ggplot(aes(x = fecha, y = pm10)) +
  geom_hline(yintercept = 100, lty = 2, color = "hotpink") +
  geom_bar(stat = "identity", fill = "skyblue") +
  geom_text(aes(x = median(fecha),
                   y = 99,label = "ECA"),
            color = "red") +
  labs(x = "", y = "PM10")+
  theme_minimal()

plotly::ggplotly(g1)
```

```{r}
#| title: "PM10 horario"

g2 <- df$df %>% 
  ggplot(aes(x = date, y = pm10)) +
  geom_hline(yintercept = 100, lty = 2, color = "hotpink") +
  geom_line(color = "skyblue") +
  geom_text(aes(x = median(df$df$date, na.rm = T),
                   y = 99,label = "ECA", color = "red")) +
  labs(x = "", y = "PM10")+
  theme_minimal() + theme(legend.position = "none")

plotly::ggplotly(g2)
```
